# Modeling epitope affnity to MHC molecules using multiple SVM kernels

Repository for Code relating to my Foundations of Computational Biology and Bioinformatics II Project

_Peter DeFord, Spring 2017_

------------------------------------------------------------------------------------------------

## Introduction

This `README` will serve to document my progress addressing the problem of modeling the affinity for short peptide sequences to MHC molecules. For a more detailed introduction, please see my [proposal](DeFord_proposal.pdf).

## Progress

March 28, 2017:

* PMD: Download [data from the MHCflurry paper](https://www.dropbox.com/sh/t59rdyvna6tktd2/AAAGUFvx56jBhOngsXhrEnzaa?dl=0), provided by Rohit

April 5, 2017:

* PMD: Collect features to use for encoding the features.

[BLOSUM50 Matrix](https://www.ncbi.nlm.nih.gov/IEB/ToolBox/C_DOC/lxr/source/data/BLOSUM50)

|**+**|   A|   R|   N|   D|   C|   Q|   E|   G|   H|   I|   L|   K|   M|   F|   P|   S|   T|   W|   Y|   V|   B|   J|   Z|   X|   -|
|-----|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|
|**A**|   5|  -2|  -1|  -2|  -1|  -1|  -1|   0|  -2|  -1|  -2|  -1|  -1|  -3|  -1|   1|   0|  -3|  -2|   0|  -2|  -2|  -1|  -1|  -5|
|**R**|  -2|   7|  -1|  -2|  -4|   1|   0|  -3|   0|  -4|  -3|   3|  -2|  -3|  -3|  -1|  -1|  -3|  -1|  -3|  -1|  -3|   0|  -1|  -5|
|**N**|  -1|  -1|   7|   2|  -2|   0|   0|   0|   1|  -3|  -4|   0|  -2|  -4|  -2|   1|   0|  -4|  -2|  -3|   5|  -4|   0|  -1|  -5|
|**D**|  -2|  -2|   2|   8|  -4|   0|   2|  -1|  -1|  -4|  -4|  -1|  -4|  -5|  -1|   0|  -1|  -5|  -3|  -4|   6|  -4|   1|  -1|  -5|
|**...**| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...| ...|
<!---|**C**|  -1|  -4|  -2|  -4|  13|  -3|  -3|  -3|  -3|  -2|  -2|  -3|  -2|  -2|  -4|  -1|  -1|  -5|  -3|  -1|  -3|  -2|  -3|  -1|  -5|--->
<!---|**Q**|  -1|   1|   0|   0|  -3|   7|   2|  -2|   1|  -3|  -2|   2|   0|  -4|  -1|   0|  -1|  -1|  -1|  -3|   0|  -3|   4|  -1|  -5|--->
<!---|**E**|  -1|   0|   0|   2|  -3|   2|   6|  -3|   0|  -4|  -3|   1|  -2|  -3|  -1|  -1|  -1|  -3|  -2|  -3|   1|  -3|   5|  -1|  -5|--->
<!---|**G**|   0|  -3|   0|  -1|  -3|  -2|  -3|   8|  -2|  -4|  -4|  -2|  -3|  -4|  -2|   0|  -2|  -3|  -3|  -4|  -1|  -4|  -2|  -1|  -5|--->
<!---|**H**|  -2|   0|   1|  -1|  -3|   1|   0|  -2|  10|  -4|  -3|   0|  -1|  -1|  -2|  -1|  -2|  -3|   2|  -4|   0|  -3|   0|  -1|  -5|--->
<!---|**I**|  -1|  -4|  -3|  -4|  -2|  -3|  -4|  -4|  -4|   5|   2|  -3|   2|   0|  -3|  -3|  -1|  -3|  -1|   4|  -4|   4|  -3|  -1|  -5|--->
<!---|**L**|  -2|  -3|  -4|  -4|  -2|  -2|  -3|  -4|  -3|   2|   5|  -3|   3|   1|  -4|  -3|  -1|  -2|  -1|   1|  -4|   4|  -3|  -1|  -5|--->
<!---|**K**|  -1|   3|   0|  -1|  -3|   2|   1|  -2|   0|  -3|  -3|   6|  -2|  -4|  -1|   0|  -1|  -3|  -2|  -3|   0|  -3|   1|  -1|  -5|--->
<!---|**M**|  -1|  -2|  -2|  -4|  -2|   0|  -2|  -3|  -1|   2|   3|  -2|   7|   0|  -3|  -2|  -1|  -1|   0|   1|  -3|   2|  -1|  -1|  -5|--->
<!---|**F**|  -3|  -3|  -4|  -5|  -2|  -4|  -3|  -4|  -1|   0|   1|  -4|   0|   8|  -4|  -3|  -2|   1|   4|  -1|  -4|   1|  -4|  -1|  -5|--->
<!---|**P**|  -1|  -3|  -2|  -1|  -4|  -1|  -1|  -2|  -2|  -3|  -4|  -1|  -3|  -4|  10|  -1|  -1|  -4|  -3|  -3|  -2|  -3|  -1|  -1|  -5|--->
<!---|**S**|   1|  -1|   1|   0|  -1|   0|  -1|   0|  -1|  -3|  -3|   0|  -2|  -3|  -1|   5|   2|  -4|  -2|  -2|   0|  -3|   0|  -1|  -5|--->
<!---|**T**|   0|  -1|   0|  -1|  -1|  -1|  -1|  -2|  -2|  -1|  -1|  -1|  -1|  -2|  -1|   2|   5|  -3|  -2|   0|   0|  -1|  -1|  -1|  -5|--->
<!---|**W**|  -3|  -3|  -4|  -5|  -5|  -1|  -3|  -3|  -3|  -3|  -2|  -3|  -1|   1|  -4|  -4|  -3|  15|   2|  -3|  -5|  -2|  -2|  -1|  -5|--->
<!---|**Y**|  -2|  -1|  -2|  -3|  -3|  -1|  -2|  -3|   2|  -1|  -1|  -2|   0|   4|  -3|  -2|  -2|   2|   8|  -1|  -3|  -1|  -2|  -1|  -5|--->
<!---|**V**|   0|  -3|  -3|  -4|  -1|  -3|  -3|  -4|  -4|   4|   1|  -3|   1|  -1|  -3|  -2|   0|  -3|  -1|   5|  -3|   2|  -3|  -1|  -5|--->
<!---|**B**|  -2|  -1|   5|   6|  -3|   0|   1|  -1|   0|  -4|  -4|   0|  -3|  -4|  -2|   0|   0|  -5|  -3|  -3|   6|  -4|   1|  -1|  -5|--->
<!---|**J**|  -2|  -3|  -4|  -4|  -2|  -3|  -3|  -4|  -3|   4|   4|  -3|   2|   1|  -3|  -3|  -1|  -2|  -1|   2|  -4|   4|  -3|  -1|  -5|--->
<!---|**Z**|  -1|   0|   0|   1|  -3|   4|   5|  -2|   0|  -3|  -3|   1|  -1|  -4|  -1|   0|  -1|  -2|  -2|  -3|   1|  -3|   5|  -1|  -5|--->
<!---|**X**|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -1|  -5|--->
<!---|**-**|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|  -5|   1|--->

pKa's obtained [here](http://academics.keene.edu/rblatchly/Chem220/hand/npaa/aawpka.htm).
For those amino acids without a pKa notated for their side chain
use the value of a standard alkane, which is around 50.

|**+**| non-polar | polar | charged |  pI   |Amine pKa|CO2H pKa| R pKa |
|-----|:---------:|:-----:|:-------:|------:|--------:|-------:|------:|
|**A**|    1      |   0   |    0    |  6.02 |  9.87   |  2.35  |     - |
|**R**|    0      |   0   |    1    | 10.76 |  8.99   |  1.82  | 12.48 |
|**N**|    0      |   1   |    0    |  5.41 |  8.72   |  2.14  |     - |
|**...**|   ...     |  ...  |   ...   |  .... |  ....   |  ....  | ..... |
<!---|**D**|    0      |   0   |    1    |  2.87 |  9.90   |  1.99  |  3.90 |--->
<!---|**C**|    0      |   1   |    0    |  5.14 | 10.70   |  1.92  |  8.37 |--->
<!---|**Q**|    0      |   1   |    0    |  5.65 |  9.13   |  2.17  |     - |--->
<!---|**E**|    0      |   0   |    1    |  3.22 |  9.47   |  2.10  |  4.07 |--->
<!---|**G**|    1      |   0   |    0    |  5.97 |  9.78   |  2.35  |     - |--->
<!---|**H**|    0      |   1   |    0    |  7.58 |  9.33   |  1.80  |  6.04 |--->
<!---|**I**|    1      |   0   |    0    |  6.02 |  9.76   |  2.32  |     - |--->
<!---|**L**|    1      |   0   |    0    |  5.98 |  9.74   |  2.33  |     - |--->
<!---|**K**|    0      |   0   |    1    |  9.74 |  9.06   |  2.16  | 10.48 |--->
<!---|**M**|    1      |   0   |    0    |  5.75 |  9.28   |  2.13  |     - |--->
<!---|**F**|    0      |   0   |    0    |  5.48 |  9.31   |  2.20  |     - |--->
<!---|**P**|    1      |   0   |    0    |  6.10 | 10.64   |  1.95  |     - |--->
<!---|**S**|    0      |   1   |    0    |  5.68 |  9.21   |  2.19  |     - |--->
<!---|**T**|    0      |   1   |    0    |  6.53 |  9.10   |  2.09  |     - |--->
<!---|**W**|    0      |   1   |    0    |  5.88 |  9.41   |  2.46  |     - |--->
<!---|**Y**|    0      |   1   |    0    |  5.65 |  9.21   |  2.20  | 10.46 |--->
<!---|**V**|    1      |   0   |    0    |  5.97 |  9.74   |  2.29  |     - |--->

Helical propensity, from [table 2](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2142718/pdf/8061613.pdf)

| AA     | s-Value      | w-Value      | -RTln(w)        | ddG            |
|--------|:------------:|:------------:|:---------------:|:--------------:|
| **A**  | 1.540        | 1.610        | -0.258          | -1.88          |
| **R**  | 1.100        | 1.200        | -0.047          | -1.67          |
| **L**  | 0.920        | 0.960        |  0.022          | -1.60          |
| **...**| .....        | .....        |  .....          | .....          |
<!---| **K**  | 0.780        | 0.960        |  0.108          | -1.52          |--->
<!---| **Eo** | 0.630        | 0.660        |  0.225          | -1.40          |--->
<!---| **M**  | 0.600        | 0.630        |  0.251          | -1.37          |--->
<!---| **Q**  | 0.530        | 0.560        |  0.314          | -1.31          |--->
<!---| **E-** | 0.430        | 0.450        |  0.433          | -1.20          |--->
<!---| **I**  | 0.420        | 0.440        |  0.445          | -1.18          |--->
<!---| **Y**  | 0.370 to 0.5 | 0.39 to 0.53 |  0.344 to 0.511 | -1.28 to -1.11 |--->
<!---| **H**  | 0.360        | 0.380        |  0.525          | -1.10          |--->
<!---| **S**  | 0.360        | 0.380        |  0.525          | -1.10          |--->
<!---| **C**  | 0.330        | 0.350        |  0.570          | -1.06          |--->
<!---| **N**  | 0.290        | 0.310        |  0.635          | -1.00          |--->
<!---| **D-** | 0.290        | 0.310        |  0.635          | -1.00          |--->
<!---| **Do** | 0.290        | 0.310        |  0.635          | -1.00          |--->
<!---| **W**  | 0.29 to 0.36 | 0.30 to 0.38 |  0.525 to 0.653 | -1.10 to -0.97 |--->
<!---| **F**  | 0.280        | 0.290        |  0.672          | -0.95          |--->
<!---| **V**  | 0.220        | 0.230        |  0.797          | -0.83          |--->
<!---| **T**  | 0.130        | 0.140        |  1.070          | -0.56          |--->
<!---| **H**  | 0.060        | 0.060        |  1.530          | -0.10          |--->
<!---| **G**  | 0.050        | 0.050        |  1.620          |  0.00          |--->
<!---| **P**  | 0.001        | 0.001        |  4.000          |  5.00          |--->

[Properties](http://www.sigmaaldrich.com/life-science/metabolomics/learning-center/amino-acid-reference-chart.html#hydro).
Again, missing pKa replaced with 50 in the table

|AA   |  MW    |residue MW| CO2H pKa | NH2 pKa | pKa R  | pI    |
|:---:|-------:|--------:|---------:|--------:|-------:|------:|
|**A**|  89.10 |   71.08 | 2.34     |  9.69   | -      |  6.00 |
|**R**| 174.20 |  156.19 | 2.17     |  9.04   | 12.48  | 10.76 |
|**N**| 132.12 |  114.11 | 2.02     |  8.80   | -      |  5.41 |
|**D**| 133.11 |  115.09 | 1.88     |  9.60   | 3.65   |  2.77 |
|**C**| 121.16 |  103.15 | 1.96     | 10.28   | 8.18   |  5.07 |
| ... |  ...   |    ...  | ...      |  ...    |  ...   |   ... |
<!---|**E**| 147.13 |  129.12 | 2.19     |  9.67   | 4.25   |  3.22 |--->
<!---|**Q**| 146.15 |  128.13 | 2.17     |  9.13   | -      |  5.65 |--->
<!---|**G**|  75.07 |   57.05 | 2.34     |  9.60   | -      |  5.97 |--->
<!---|**H**| 155.16 |  137.14 | 1.82     |  9.17   | 6.00   |  7.59 |--->
<!---|**O**| 131.13 |  113.11 | 1.82     |  9.65   | -      |     - |--->
<!---|**I**| 131.18 |  113.16 | 2.36     |  9.60   | -      |  6.02 |--->
<!---|**L**| 131.18 |  113.16 | 2.36     |  9.60   | -      |  5.98 |--->
<!---|**K**| 146.19 |  128.18 | 2.18     |  8.95  1| 0.53   |  9.74 |--->
<!---|**M**| 149.21 |  131.20 | 2.28     |  9.21   | -      |  5.74 |--->
<!---|**F**| 165.19 |  147.18 | 1.83     |  9.13   | -      |  5.48 |--->
<!---|**P**| 115.13 |   97.12 | 1.99     | 10.60   | -      |  6.30 |--->
<!---|**U**| 139.11 |  121.09 |    -     |     -   | -      |  5.68 |--->
<!---|**S**| 105.09 |   87.08 | 2.21     |  9.15   | -      |  5.68 |--->
<!---|**T**| 119.12 |  101.11 | 2.09     |  9.10   | -      |  5.60 |--->
<!---|**W**| 204.23 |  186.22 | 2.83     |  9.39   | -      |  5.89 |--->
<!---|**Y**| 181.19 |  163.18 | 2.20     |  9.11  1| 0.07   |  5.66 |--->
<!---|**V**| 117.15 |   99.13 | 2.32     |  9.62   | -      |  5.96 |--->

[Hydrophobicity Index](http://www.sigmaaldrich.com/life-science/metabolomics/learning-center/amino-acid-reference-chart.html#hydro)

|AA   | pH2 |  pH7 |
|:---:|----:|-----:|
|**L**| 100 |   97 |
|**I**| 100 |   99 |
|**F**|  92 |  100 |
|**W**|  84 |   97 |
|**V**|  79 |   76 |
| ... | ... |  ... |
<!---|**M**|  74 |   74 |--->
<!---|**C**|  52 |   49 |--->
<!---|**Y**|  49 |   63 |--->
<!---|**A**|  47 |   41 |--->
<!---|**T**|  13 |   13 |--->
<!---|**E**|   8 |  -31 |--->
<!---|**G**|   0 |    0 |--->
<!---|**S**|  -7 |   -5 |--->
<!---|**Q**| -18 |  -10 |--->
<!---|**D**| -18 |  -55 |--->
<!---|**R**| -26 |  -14 |--->
<!---|**K**| -37 |  -23 |--->
<!---|**N**| -41 |  -28 |--->
<!---|**H**| -42 |    8 |--->
<!---|**P**| -46 |  -46 |--->

Download the full human proteome from [UniProt](http://www.uniprot.org/uniprot/?query=reviewed%3Ayes+AND+proteome%3Aup000005640).

Using a script [`count_kmer_freq.py`](scripts/count_kmer_freq.py) I extracted the kmer frequency for all kmers present in the proteome with `k = [4, 6, 8, 10]`. The top 5 kmers for each are:

| k = 4  | 6        | 8          | 10           |
|:------:|:--------:|:----------:|:------------:|
| `EEEE` | `HTGEKP` | `IHTGEKPY` | `QQQQQQQQQQ` |
| `PPPP` | `TGEKPY` | `RIHTGEKP` | `IHTGEKPYKC` |
| `AAAA` | `EEEEEE` | `QQQQQQQQ` | `HQRIHTGEKP` |
| `SSSS` | `AAAAAA` | `HTGEKPYK` | `SSSSSSSSSS` |
| `LLLL` | `IHTGEK` | `TGEKPYKC` | `EEEEEEEEEE` |
| `HTGE` | `PPPPPP` | `EEEEEEEE` | `AAAAAAAAAA` |
| `GEKP` | `ECGKAF` | `AAAAAAAA` | `QRIHTGEKPY` |
| `TGEK` | `QQQQQQ` | `HTGEKPYE` | `KPYKCEECGK` |
| `GGGG` | `SSSSSS` | `TGEKPYEC` | `YKCEECGKAF` |
| `EKPY` | `EKPYKC` | `SSSSSSSS` | `HTGEKPYKCE` |

At each _k_ the distribution looks like this example from `k = 10`. Note: The y-axis is log scaled:
![](output/freqdist_k10.png)
